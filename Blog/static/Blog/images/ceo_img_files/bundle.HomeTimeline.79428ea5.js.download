(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{cOLG:function(e,t,s){"use strict";s.r(t),s.d(t,"HomeTimeline",(function(){return pt}));var a=s("KEM+"),i=s.n(a),n=s("ERkP"),o=s("v6aA"),c=s("es0u"),r=s("wM4e"),l=s("hqKg"),h=s("QK5w"),m=s("G6rE"),p=s("oEGd");const u=Object(l.createSelector)(h.a,m.e.selectLoggedInUser,r.g,r.b,((e,t,s,a)=>({isInitialScreen:!e,loggedInUserAvatarURI:t&&t.profile_image_url_https,loggedInUserName:t&&t.name,useLatest:s,configurationFetchStatus:a})));var d=Object(p.c)(u),_=s("s14A"),T=s("dwig"),v=s("v//M"),f=s("0+qk");s("kYxP");const b=(e,{inactivityThresholdMs:t,lastFrustrationEventTimestamp:s=0})=>{const a=60*e.getNumberValue("home_timeline_latest_timeline_min_time_to_autoswitch_minutes",720)*1e3,i=60*e.getNumberValue("home_timeline_latest_timeline_autoswitch_half_life_minutes",20160)*1e3,n=t||a;return Math.max(a,n*Math.pow(2,(s-Date.now())/i))},w=(e,t)=>{const s=60*e.getNumberValue("home_timeline_latest_timeline_max_time_to_autoswitch_minutes",10080)*1e3,a=e.getNumberValue("home_timeline_latest_timeline_autoswitch_threshold_multiplier",2);return Math.min(s,a*t)},E=(e,{useLatest:t,lastActiveOnLatestTimestamp:s,inactivityThresholdMs:a,lastFrustrationEventTimestamp:i})=>{if(e.isTrue("home_timeline_latest_timeline_switch_enabled")&&t){return(({lastActiveOnLatestTimestamp:e,inactivityThresholdMs:t})=>Date.now()-e>t)({lastActiveOnLatestTimestamp:s,inactivityThresholdMs:b(e,{inactivityThresholdMs:a,lastFrustrationEventTimestamp:i})})}return!1};var g=s("1YZw"),y=s("rxPX"),S=Object(y.a)().propsFromState((()=>({inactivityThresholdMs:r.d,autoSwitchTimestamp:r.a,lastFrustrationEventTimestamp:r.f}))).propsFromActions((()=>({addToast:g.b,updateAutoSwitchTimestamp:r.h,updateBehavior:r.i,updateInactivityThresholdMs:r.j,updateLastFrustrationEventTimestamp:r.l}))).withAnalytics(),L=s("3XMw"),M=s.n(L),F=s("/yvb"),I=s("Lsrn"),A=s("k/Ka");const x=(e={})=>Object(A.a)("svg",{...e,style:[I.a.root,e.style],viewBox:"0 0 24 24"},n.createElement("g",null,n.createElement("path",{d:"M22.772 10.506l-5.618-2.192-2.16-6.5c-.102-.307-.39-.514-.712-.514s-.61.207-.712.513l-2.16 6.5-5.62 2.192c-.287.112-.477.39-.477.7s.19.585.478.698l5.62 2.192 2.16 6.5c.102.306.39.513.712.513s.61-.207.712-.513l2.16-6.5 5.62-2.192c.287-.112.477-.39.477-.7s-.19-.585-.478-.697zm-6.49 2.32c-.208.08-.37.25-.44.46l-1.56 4.695-1.56-4.693c-.07-.21-.23-.38-.438-.462l-4.155-1.62 4.154-1.622c.208-.08.37-.25.44-.462l1.56-4.693 1.56 4.694c.07.212.23.382.438.463l4.155 1.62-4.155 1.622zM6.663 3.812h-1.88V2.05c0-.414-.337-.75-.75-.75s-.75.336-.75.75v1.762H1.5c-.414 0-.75.336-.75.75s.336.75.75.75h1.782v1.762c0 .414.336.75.75.75s.75-.336.75-.75V5.312h1.88c.415 0 .75-.336.75-.75s-.335-.75-.75-.75zm2.535 15.622h-1.1v-1.016c0-.414-.335-.75-.75-.75s-.75.336-.75.75v1.016H5.57c-.414 0-.75.336-.75.75s.336.75.75.75H6.6v1.016c0 .414.335.75.75.75s.75-.336.75-.75v-1.016h1.098c.414 0 .75-.336.75-.75s-.336-.75-.75-.75z"})));x.metadata={width:24,height:24};var C=x,O=s("JGUy");var P=({accessibilityLabel:e,hoverLabel:t,renderMenu:s,onPress:a})=>{const i=n.createElement(C,null),o=Object(O.a)();return n.createElement(F.a,{accessibilityLabel:e,hoverLabel:{label:t},icon:i,onPress:a,pullRight:!0,renderMenu:s,type:o})},k=s("mjJ+"),j=s("rHpw");const R=(e={})=>Object(A.a)("svg",{...e,style:[I.a.root,e.style],viewBox:"0 0 36 36"},n.createElement("g",null,n.createElement("path",{d:"M27.325 20.595c0 7.333-5.913 13.278-13.206 13.278S.912 27.928.912 20.595 6.825 7.317 14.12 7.317s13.205 5.944 13.205 13.278",fill:"#71C9F8"}),n.createElement("path",{d:"M24.576 20.682c0 5.802-4.678 10.506-10.45 10.506-5.77 0-10.448-4.704-10.448-10.506s4.678-10.506 10.45-10.506c5.77 0 10.448 4.704 10.448 10.506",fill:"#97E3FF"}),n.createElement("path",{d:"M18.98 20.94l-3.86-.583v-6.215c0-.552-.45-1-1-1s-1 .448-1 1v7.076c0 .06.023.112.033.17.007.042.012.082.025.123.026.084.063.158.11.23.022.038.044.075.072.11.05.06.11.11.173.158.042.03.08.06.128.086.065.034.133.055.204.074.04.01.072.035.114.04l4.704.71c.05.01.1.012.15.012.487 0 .914-.355.988-.85.08-.548-.295-1.058-.84-1.14z",fill:"#005FD1"}),n.createElement("path",{d:"M24.553 20.682c0 5.79-4.68 10.5-10.434 10.5S3.683 26.47 3.683 20.68c0-2.953 1.227-5.707 3.31-7.665l.674 1.127c.38.635 1.227.668 1.524.06l1.153-2.36 1.312-2.687c.24-.49-.104-1.067-.65-1.088l-2.988-.116-2.625-.1c-.678-.027-1.05.735-.67 1.37l.804 1.344C2.613 13.065.883 16.736.883 20.683c0 7.333 5.937 13.298 13.234 13.298s13.234-5.964 13.234-13.297h-2.8z",fill:"#1DA1F2"}),n.createElement("path",{d:"M35 13.36h-1.467v-1.34c0-.552-.448-1-1-1s-1 .448-1 1v1.34h-1.467c-.552 0-1 .45-1 1s.448 1 1 1h1.467v1.342c0 .552.448 1 1 1s1-.448 1-1v-1.34H35c.552 0 1-.45 1-1s-.448-1-1-1z",fill:"#FFAD1F"}),n.createElement("path",{d:"M28.646 4.138h-2.01v-2.01c0-.552-.448-1-1-1s-1 .448-1 1v2.01h-2.01c-.552 0-1 .448-1 1s.448 1 1 1h2.01v2.01c0 .552.448 1 1 1s1-.448 1-1v-2.01h2.01c.552 0 1-.448 1-1s-.447-1-1-1z",fill:"#F6809A"})));R.metadata={width:36,height:36};var z=R;const D=(e={})=>Object(A.a)("svg",{...e,style:[I.a.root,e.style],viewBox:"0 0 36 36"},n.createElement("g",null,n.createElement("path",{d:"M35.508 15.41l-9.295-3.387L22.438 1.47c-.108-.302-.357-.48-.722-.495-.322.007-.604.22-.698.53l-3.293 10.71-9.132 3.805c-.285.118-.467.4-.46.708.007.308.203.58.492.686L17.92 20.8l3.775 10.552c.107.298.39.496.704.496h.016c.322-.007.604-.22.698-.53l3.293-10.712 9.132-3.803c.284-.118.466-.4.46-.708-.007-.308-.203-.58-.492-.686z",fill:"#61BCF6"}),n.createElement("path",{d:"M9.57 4.715l-2.906.065-.06-2.715C6.585 1.34 5.983.763 5.256.78 4.53.796 3.955 1.4 3.97 2.125l.063 2.715-2.747.062C.56 4.92-.016 5.522 0 6.248c.017.726.62 1.302 1.346 1.285l2.747-.062.062 2.716c.017.726.62 1.302 1.345 1.286.726-.016 1.302-.62 1.286-1.345l-.062-2.715 2.905-.066c.725-.017 1.3-.62 1.285-1.346-.017-.726-.62-1.302-1.346-1.285z",fill:"#F16888"}),n.createElement("path",{d:"M14.205 29.69l-1.65.036-.034-1.518c-.016-.726-.618-1.302-1.344-1.286s-1.302.62-1.286 1.345l.034 1.518-1.54.035c-.726.016-1.302.62-1.286 1.345.017.726.62 1.302 1.345 1.286l1.54-.034.034 1.518c.017.726.62 1.302 1.345 1.286.726-.016 1.302-.62 1.286-1.345l-.034-1.518 1.65-.037c.726-.016 1.302-.62 1.286-1.345-.016-.727-.62-1.303-1.345-1.286z",fill:"#FD9E1A"})));D.metadata={width:36,height:36};var U=D,N=s("3JQt"),H=s("M2x3");const B=M.a.j681ac0d,W=M.a.g8220472,J=M.a.ccdd3766,q=M.a.g2657de3,V=M.a.d126cb7c,G=M.a.c41ecf3c,$=M.a.d18aa6d4,K=M.a.bc52b0cd,Q=M.a.j6382fe9,X=M.a.f89f6785,Y=M.a.e4acfd11;class Z extends n.PureComponent{constructor(...e){super(...e),i()(this,"_renderActionMenu",(e=>{const{useLatest:t}=this.props,s=t?$:G,a=t?z:U;return n.createElement(k.a,{DescriptionIcon:a,description:s,descriptionStyle:ee.description,isFixed:!0,items:this._getActionMenuItems(),onCloseRequested:e})})),i()(this,"_getActionMenuItems",(()=>{const{useLatest:e}=this.props,t=e?Y:X;return[{text:e?K:Q,onClick:this._handleTimelineSwitch,Icon:N.a,subText:t},{link:"/settings/content_preferences",text:B,onClick:this._handleContentPreferences,Icon:H.a}]})),i()(this,"_handleTimelineSwitch",(e=>{const{onToggle:t}=this.props;e(),t()})),i()(this,"_handleContentPreferences",(e=>{const{onContentPreferencesSelect:t}=this.props;e(),t()}))}render(){const{useLatest:e,onPress:t}=this.props,s=e?W:J,a=e?V:q;return n.createElement(P,{accessibilityLabel:s,hoverLabel:a,onPress:t,renderMenu:this._renderActionMenu})}}const ee=j.a.create((e=>({description:{fontSize:e.fontSizes.large,color:e.colors.text,textAlign:"center",fontWeight:e.fontWeights.bold}})));var te=Z,se=s("aWzz");const ae=M.a.e4c6d14c,ie=M.a.bffa2da7;class ne extends n.Component{constructor(...e){super(...e),i()(this,"_handleToggle",(()=>{const{updateBehavior:e,useLatest:t,addToast:s,analytics:a,updateInactivityThresholdMs:i,inactivityThresholdMs:n,autoSwitchTimestamp:o,updateAutoSwitchTimestamp:c,updateLastFrustrationEventTimestamp:r,lastFrustrationEventTimestamp:l}=this.props;this.context.viewport.scrollToTop();if(((e,t)=>{if(!t)return!1;const s=1e3*e.getNumberValue("home_timeline_latest_timeline_threshold_to_increase_autoswitch_seconds",60);return Date.now()-t<s})(this.context.featureSwitches,o)){const e=b(this.context.featureSwitches,{inactivityThresholdMs:n,lastFrustrationEventTimestamp:l});i({inactivityThresholdMs:w(this.context.featureSwitches,e)}),r({lastFrustrationEventTimestamp:Date.now()})}let h={};if(o){h={duration_ms:Date.now()-o}}a.scribe({component:"customize",element:t?"see_top":"see_latest",action:"click",data:h}),o&&c({autoSwitchTimestamp:null});const m=t?ae:ie;e({useLatest:!t}).then((()=>{s({text:m})}))})),i()(this,"_handleSwitchPress",(()=>{const{analytics:e}=this.props;e.scribe({section:"navigation_bar",element:"customize_button",action:"click"})})),i()(this,"_handleContentPreferencesSelect",(()=>{const{analytics:e}=this.props;e.scribe({component:"customize",element:"see_preferences",action:"click"})}))}render(){const{useLatest:e}=this.props;return n.createElement(te,{onContentPreferencesSelect:this._handleContentPreferencesSelect,onPress:this._handleSwitchPress,onToggle:this._handleToggle,useLatest:e})}}i()(ne,"contextTypes",{viewport:se.object,featureSwitches:se.any});var oe=S(ne),ce=s("2dXj"),re=Object(y.a)().propsFromState((()=>({loggedInUser:m.e.selectLoggedInUser}))).adjustStateProps((({loggedInUser:e})=>({userAvatarURI:e&&e.profile_image_url_https,userName:e&&e.name}))),le=s("N5qz"),he=s("MWbm"),me=s("cHvH"),pe=s("5mJL"),ue=s("DNho"),de=s("XP29"),_e=s("t62R"),Te=s("cjZk"),ve=s("3rWK"),fe=s("ll3R"),be=s("pNJr"),we=s("J0mu");const Ee=M.a.bea869b3,ge=M.a.e349147b,ye=j.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space8},avatarColumn:{flexGrow:1,minWidth:e.spaces.space32,maxWidth:e.spaces.space48},avatar:{width:"100%"},body:{flexDirection:"column",flexGrow:1},fakeInput:{paddingTop:`calc(${e.spaces.space12} + ${e.spaces.space2})`,paddingBottom:e.spaces.space8,paddingHorizontal:e.spaces.space2},toolbar:{alignItems:"center",flexDirection:"row",justifyContent:"space-between",marginRight:e.spaces.space2,marginTop:`calc(${e.spaces.space16} + ${e.spaces.space2})`},toolbarSection:{alignItems:"center",flexDirection:"row"},iconContainer:{marginLeft:-e.spacesPx.space2},icon:{color:e.colors.primary,height:"1.5em",marginRight:e.spaces.space12,marginLeft:`calc(${e.spaces.space4} + ${e.spaces.space1})`,width:"1.5em"},firstIcon:{marginLeft:0},lastIcon:{marginRight:0},tweetButton:{marginLeft:e.spaces.space12}})));var Se=re((({userAvatarURI:e})=>n.createElement(me.a,null,(({windowWidth:t})=>{const s=!le.a.isOneColumnSquishedLayout(t);return n.createElement(pe.a,{avatarCell:n.createElement(ue.a.Consumer,null,(({avatarSize:t})=>n.createElement(de.a,{size:t,style:ye.avatar,uri:e}))),avatarCellStyle:ye.avatarColumn,cellStyle:ye.body,style:ye.root},n.createElement(_e.c,{color:"gray600",numberOfLines:1,size:"large",style:ye.fakeInput},ge),n.createElement(he.a,{style:ye.toolbar},n.createElement(he.a,{style:[ye.toolbarSection,ye.iconContainer]},n.createElement(Te.a,{style:[ye.icon,ye.firstIcon]}),n.createElement(ve.a,{style:ye.icon}),s?n.createElement(fe.a,{style:ye.icon}):null,n.createElement(be.a,{style:ye.icon}),s?n.createElement(we.a,{style:[ye.icon,ye.lastIcon]}):null),n.createElement(he.a,{style:ye.toolbarSection},n.createElement(F.a,{disabled:!0,style:ye.tweetButton,type:"primary"},Ee))))})))),Le=s("zb92"),Me=Object(Le.a)({loader:()=>(ce.a.preload()||Promise.resolve()).then((()=>Promise.all([s.e(0),s.e(3),s.e(8),s.e(6),s.e(66)]).then(s.bind(null,"M5JI")))),renderPlaceholder:()=>n.createElement(Se,null)});const Fe=()=>window.performance&&"function"==typeof window.performance.now;var Ie=s("yoO3"),Ae=s("aeN7"),xe=Object(y.a)().propsFromState((()=>({inactivityThresholdMs:r.d,lastActiveOnLatestTimestamp:r.e,lastFrustrationEventTimestamp:r.f}))).propsFromActions((()=>({addToast:g.b,updateAutoSwitchTimestamp:r.h,updateBehavior:r.i,updateLastActiveOnLatestTimestamp:r.k}))).withAnalytics(),Ce=s("7BdX"),Oe=s("QIgh"),Pe=s("8UdT"),ke=s("iu0J"),je=s("AP4B");var Re={...Object(Oe.a)({tweetDismissable:!0,shouldSelfThreadIncludeAvatar:!0}),...je.a,[Pe.b.EventSummary]:Object(ke.a)({errorContext:"HOME_TIMELINE_SCREEN"})},ze=s("MDbM"),De=s("FIs5");const Ue=M.a.d2c66f1f,Ne=M.a.c3fbf1da,He=M.a.bf17ded9;var Be=({onImpression:e})=>n.createElement(De.a,{buttonLink:"/i/connect_people",buttonText:He,header:Ue,message:Ne,onImpression:e}),We=s("EUHl"),Je=s("fTQJ"),qe=s("WA1W"),Ve=s("oQhu"),Ge=s("/NU0");const $e=M.a.f089620b,Ke=M.a.e4c6d14c,Qe={count:void 0},Xe=Object(Ve.a)(((e,t,s)=>e&&t?Object(qe.a)(s):Object(qe.b)(s)));class Ye extends n.Component{constructor(e,t){super(e,t),i()(this,"_handleEntriesUpdate",(({entries:e,fetchStatus:t})=>{const{isInitialScreen:s,recordTTFT:a,useLatest:i,updateLastActiveOnLatestTimestamp:n}=this.props;if(t===ze.a.FAILED&&(this._shouldRecordTTFT=!1),this._shouldRecordTTFT&&s&&e.length){const t=e.some((({type:e})=>e===Pe.b.Tweet));this._shouldRecordTTFT=!1,t&&a()}if(this._latestTimelineSwitchEnabled&&i){n(Date.now())}})),i()(this,"_renderEmptyTimeline",(()=>n.createElement(Be,{onImpression:this._handleEmptyHtlImpression}))),i()(this,"_handleEmptyHtlImpression",(()=>{const{analytics:e}=this.props;e.scribe({component:"empty_message",action:"impression"})})),this._shouldRecordTTFT=!0,this._latestTimelineSwitchEnabled=this.context.featureSwitches.isTrue("home_timeline_latest_timeline_switch_enabled"),this._checkIsAutoSwitchRequired()}componentDidMount(){this._requiresAutoSwitch&&(this._performAutoSwitch(),this._requiresAutoSwitch=!1)}render(){if(this._requiresAutoSwitch)return null;const{useLatest:e,timelineRef:t}=this.props,s=Xe(this._latestTimelineSwitchEnabled,e,this.context.featureSwitches);return n.createElement(Je.a,{displayLocation:Ce.a.TIMELINE_HOME,entryConfiguration:Re,fetchTopOptions:Qe,module:s,newTweetsPillMode:We.a.URT,onEntriesUpdate:this._handleEntriesUpdate,renderEmptyState:this._renderEmptyTimeline,timelineRef:t,title:$e})}_performAutoSwitch(){const{updateBehavior:e,addToast:t,analytics:s,updateAutoSwitchTimestamp:a,lastActiveOnLatestTimestamp:i,inactivityThresholdMs:n,lastFrustrationEventTimestamp:o}=this.props,c=Object(Ge.a)(i)?((e,{lastActiveOnLatestTimestamp:t,inactivityThresholdMs:s,lastFrustrationEventTimestamp:a})=>({duration_ms:Date.now()-t,event_value:b(e,{inactivityThresholdMs:s,lastFrustrationEventTimestamp:a})}))(this.context.featureSwitches,{lastActiveOnLatestTimestamp:i,inactivityThresholdMs:n,lastFrustrationEventTimestamp:o}):void 0;s.scribe({action:"automatic_switch_to_home",data:c}),a({autoSwitchTimestamp:Date.now()}),e({useLatest:!1}).then((()=>{t({text:Ke})}))}_checkIsAutoSwitchRequired(){const{useLatest:e,lastActiveOnLatestTimestamp:t,inactivityThresholdMs:s,lastFrustrationEventTimestamp:a}=this.props;this._requiresAutoSwitch=!!Object(Ge.a)(t)&&E(this.context.featureSwitches,{useLatest:e,lastActiveOnLatestTimestamp:t,inactivityThresholdMs:s,lastFrustrationEventTimestamp:a})}}i()(Ye,"defaultProps",{recordTTFT:Ae.e}),i()(Ye,"contextType",o.a);var Ze=xe(Ye),et=s("7JQg"),tt=s("VS6U"),st=s("Es6L"),at=s("LsPn"),it=s("aITJ"),nt=s("0yYu"),ot=s("mw9i");const ct=M.a.i5f7b6b8,rt=M.a.d126cb7c,lt=M.a.ha8209bb,ht={page:"home"},mt={page:"home_latest"};class pt extends n.Component{constructor(e,t){super(e,t),i()(this,"_unmounted",!1),i()(this,"_renderTimeline",(()=>{const{useLatest:e,isInitialScreen:t}=this.props;return n.createElement(_.a,null,n.createElement(Ze,{isInitialScreen:t,timelineRef:this._setTimelineRef,useLatest:e}))})),i()(this,"_renderPrimaryContent",(()=>{const{history:e,location:t,configurationFetchStatus:s}=this.props,a=n.createElement(f.a,{history:e});return n.createElement(n.Fragment,null,Object(st.a)()?n.createElement(n.Fragment,null,n.createElement(Me,{history:e,location:t}),n.createElement(nt.a,null)):null,n.createElement(T.a,{component:ot.a,fab:a},it.b.isKaiOS()?n.createElement(at.a,{leftText:ct,onLeftClick:this._handleSoftLeftClick}):null,n.createElement(v.a,{fetchStatus:s,render:this._renderTimeline})))})),i()(this,"_handleSoftLeftClick",(()=>{const{history:e}=this.props;e.push("/account")})),i()(this,"_handleTabRefresh",(()=>{this._timeline&&this._timeline.refreshOrGoTop()})),i()(this,"_handleWindowFocus",(()=>{this._timeline&&this._timeline.fetchTop({onlyIfStale:!0})})),i()(this,"_setTimelineRef",(e=>{this._timeline=e})),this._latestTimelineSwitchEnabled=this.context.featureSwitches.isTrue("home_timeline_latest_timeline_switch_enabled")}componentDidMount(){if(window.addEventListener("focus",this._handleWindowFocus),this.context.featureSwitches.isTrue("responsive_web_framerate_tracking_home_enabled")){const e=`home${it.b.isDesktopOS()?"":"_mobile"}`;(Fe()?s.e(279).then(s.bind(null,"Iid0")).then((({default:e})=>e)):Promise.resolve(void 0)).then((t=>{!this._unmounted&&t&&(this._fpsTracking=t({reportNamespace:e}))}))}}componentWillUnmount(){this._unmounted=!0,window.removeEventListener("focus",this._handleWindowFocus),this._fpsTracking&&this._fpsTracking.stop()}render(){const{useLatest:e,history:t}=this.props,s=this._latestTimelineSwitchEnabled?n.createElement(oe,{useLatest:e}):void 0,a=this._latestTimelineSwitchEnabled&&e?rt:lt;return n.createElement(et.b,{namespace:this._getScribeNamespace()},n.createElement(Ie.a,null,n.createElement(tt.a,{history:t,onTabRefresh:this._handleTabRefresh,primaryContent:this._renderPrimaryContent,rightControl:s,sidebarContent:n.createElement(c.a,null),title:a})))}_getScribeNamespace(){const{useLatest:e}=this.props;return e?mt:ht}}i()(pt,"contextType",o.a);t.default=d(pt)}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.HomeTimeline.79428ea5.js.map
(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{"5RdJ":function(e,t,s){"use strict";s.r(t);var o=s("97Jx"),i=s.n(o),r=s("ERkP"),n=s("+cai"),a=s("nvLZ");t.default=function(e){return r.createElement(a.a,i()({},e,{emojiInfo:n.default}))}},nvLZ:function(e,t,s){"use strict";var o=s("97Jx"),i=s.n(o),r=s("KEM+"),n=s.n(r),a=(s("kYxP"),s("ERkP")),c=s("py1r"),l=s("I4+6"),h=s("oLZl"),d=s("rHpw"),u=s("MWbm");const m=l.a.generate({backgroundColor:"transparent",color:d.a.theme.colors.primary});class p extends a.PureComponent{constructor(...e){super(...e),n()(this,"_handleClick",(()=>{const{category:e,onClick:t}=this.props;t(e)})),n()(this,"_handleKeyDown",(e=>{const{key:t}=e,{altKey:s,ctrlKey:o,metaKey:i}=e;s||o||i||t===h.a.Enter&&(this._handleClick(),e.preventDefault(),e.stopPropagation())}))}render(){const{icon:e,isActive:t,isDisabled:s}=this.props;return a.createElement(c.a,{disabled:s},(({isHovered:o,isPressed:i,isFocused:r})=>a.createElement(u.a,{accessibilityDisabled:s,accessibilityRole:"button",onClick:this._handleClick,onKeyDown:r?this._handleKeyDown:void 0,style:[f.wrapper,o||t?void 0:f.faded,t&&f.active,m.transitionStyle,o&&m.hoverStyle,i&&m.pressedStyle,r&&m.focusedStyle]},e)))}}const f=d.a.create((e=>({wrapper:{alignItems:"center",borderBottomWidth:e.borderWidths.medium,borderBottomStyle:"solid",borderBottomColor:"transparent",flex:1,paddingVertical:e.spaces.space4},active:{borderBottomColor:e.colors.primary},faded:{filter:"grayscale(100%) contrast(80%)",opacity:.5}})));var g=p,_=s("z4Oz");const y=(e,t)=>{const s=t&&t.codepoint;if(!(s&&v(e.skin_variations,s)>1))return s&&e.skin_variations&&e.skin_variations[s]?e.skin_variations[s]:void 0},v=(e={},t)=>{let s=0;for(const o in e)t&&o.indexOf(t)>=0&&(s+=1);return s},w=()=>`emojiPicker-${Math.random()}`;var S=s("U+bB"),C=s("3XMw"),k=s.n(C);const j="none",E="light",b="medium-light",R="medium",I="medium-dark",P="dark",T={[j]:{id:j,name:k.a.ff3dd27b,color:"#FFDC5D"},[E]:{codepoint:"1f3fb",id:E,name:k.a.b554fcf3,color:"#F7DECE"},[b]:{codepoint:"1f3fc",id:b,name:k.a.j590b148,color:"#F3D2A2"},[R]:{codepoint:"1f3fd",id:R,name:k.a.e7d4ee85,color:"#D5AB88"},[I]:{codepoint:"1f3fe",id:I,name:k.a.ia423ebb,color:"#AF7E57"},[P]:{codepoint:"1f3ff",id:P,name:k.a.a2cf0941,color:"#7C533E"}},D={search:k.a.j824dc05,notFoundHeader:k.a.e39c4391,notFoundMessage:k.a.f2625275,skintext:k.a.d67ad795,clear:k.a.e6388bfa,recentCategoryName:k.a.j7c67ec9,searchCategoryName:k.a.da539d38},x={EmojiWidth:d.a.theme.spaces.space20,EmojiHeight:d.a.theme.spaces.space20,EmojiGutter:d.a.theme.spaces.space4},F="search",H="recent";class L extends a.PureComponent{render(){const{accessibilityLabel:e,skinTone:t,emoji:s,style:o}=this.props,i=((e,t)=>{const s=(y(e,t)||e).unified;return _.a.getTwemojiUrl(s)})(s,t);return i?a.createElement(S.a,{accessibilityLabel:e,alt:s.name,draggable:!1,resizeMode:"stretch",source:i,style:[O.root,o]}):null}}const O=d.a.create((e=>({root:{height:x.EmojiHeight,width:x.EmojiWidth}})));var B=L;const z={people:"ðŸ˜€",nature:"ðŸ»",food:"ðŸ”",activity:"âš½ï¸",travel:"ðŸš˜",objects:"ðŸ’¡",symbols:"ðŸ”£",flags:"ðŸš©",recent:"ðŸ•‘"};class A extends a.PureComponent{render(){const{activeCategory:e,categories:t,onAnchorClick:s,disableAll:o}=this.props;return a.createElement(u.a,{style:U.root},t.map((t=>{const{anchorless:i,emojis:r,id:n,name:c}=t,l=r&&0===r.length||o,h=!!e&&t.id===e.id;return i?null:a.createElement(g,{category:t,icon:this._getIcon(n,c),isActive:h,isDisabled:l,key:n,onClick:s})})))}_getIcon(e,t){const{emojiData:s}=this.props,o=s[z[e]];return a.createElement(B,{accessibilityLabel:t,emoji:o})}}const U=d.a.create((e=>({root:{flexDirection:"row",justifyContent:"space-between"}})));var M=A,N=s("t62R"),K=s("/yvb"),W=s("2ZFc");class V extends a.PureComponent{constructor(...e){super(...e),n()(this,"_handleHover",(()=>{const{emoji:e,onHover:t}=this.props;t&&t(e)})),n()(this,"_handleFocus",(()=>{const{emoji:e,onFocus:t}=this.props;t&&t(e)})),n()(this,"_getBackgroundPositionStyle",(()=>{const{emoji:e,spriteSheetColumns:t,spriteSheetRows:s}=this.props,o=this.props.spritePosition||e.sprite_position,i=100/(s-1);return`${100/(t-1)*o[0]}% ${i*o[1]}%`})),n()(this,"_handleClick",(()=>{const{emoji:e,onSelect:t}=this.props;t&&t(e)}))}render(){const{ariaDescendantId:e,emoji:t,emojiName:s,spriteUrl:o}=this.props,i={backgroundImage:`url(${o})`,backgroundPosition:this._getBackgroundPositionStyle(),backgroundSize:`${100*this.props.spriteSheetColumns}% ${100*this.props.spriteSheetRows}%`};return a.createElement(c.a,{onFocusRingGained:this._handleFocus,onHoverIn:this._handleHover},(({isFocused:o,isHovered:r,isPressed:n})=>a.createElement(u.a,{accessibilityLabel:s||t.name,accessibilityRole:"option",accessibilityState:{selected:!!e},nativeID:e,onClick:this._handleClick,style:[G.container,$.transitionStyle,r&&$.hoverStyle,n&&$.pressedStyle,(o||e)&&$.focusedStyle]},a.createElement(u.a,{style:[i,G.emoji]}))))}}const $=l.a.generate({backgroundColor:d.a.theme.colors.transparent,color:d.a.theme.colors.gray600}),G=d.a.create((e=>({container:{alignItems:"center",borderRadius:e.borderRadii.small,boxSizing:"border-box",padding:x.EmojiGutter},emoji:{display:"inline-block",outlineStyle:"none",height:x.EmojiHeight,width:x.EmojiWidth}})));var J=V,q=s("FIs5"),Z=s("mtvn"),Y=s("7nmT"),Q=s.n(Y);class X extends a.PureComponent{render(){const{children:e,style:t,withTopBorder:s}=this.props;return a.createElement(u.a,{style:[ee.root,s?ee.topBorder:ee.bottomBorder,t]},e)}}n()(X,"defaultProps",{withTopBorder:!1});const ee=d.a.create((e=>({root:{backgroundColor:e.colors.cellBackground,borderColor:e.colors.borderColor,padding:e.spaces.space12},bottomBorder:{borderBottomWidth:e.borderWidths.small},topBorder:{borderTopWidth:e.borderWidths.small}})));var te=X,se=s("OiMc");class oe extends a.PureComponent{constructor(...e){super(...e),n()(this,"_createDismissOnSelect",(e=>t=>{const{onSelect:s}=this.props;e(),s&&s(t)})),n()(this,"_getEmojisForActiveSkinTone",(e=>{const{activeSkinTone:t,emoji:s,...o}=this.props,{codepoint:r}=t,{skin_variations:n}=s,c=[a.createElement(J,i()({},o,{emoji:{...s},key:"none",onSelect:this._createDismissOnSelect(e),spritePosition:s.sprite_position}))];for(const t in n)if(r&&t.indexOf(r)>=0){const{unified:r,sprite_position:l}=n[t];c.push(a.createElement(J,i()({},o,{emoji:{...s,text:r},key:t,onSelect:this._createDismissOnSelect(e),spritePosition:l})))}return c})),n()(this,"renderEmojis",(e=>{const t=((e,t)=>{const s=null==e?0:e.length;if(!s||t<1)return[];let o=0,i=0;const r=new Array(Math.ceil(s/t));for(;o<s;)r[i]=e.slice(o,o+=t),i+=1;return r})(this._getEmojisForActiveSkinTone(e),10);return a.createElement(u.a,{style:ie.emojisContainer},t.map(((e,t)=>a.createElement(u.a,{key:t,style:ie.row},e))))}))}render(){const{activeSkinTone:e,emoji:t,onSelect:s,...o}=this.props;return a.createElement(se.a,{contentStyle:ie.contentStyle,renderContent:this.renderEmojis,withArrow:!0},a.createElement(J,i()({},o,{emoji:t,spritePosition:t.sprite_position})))}}const ie=d.a.create((e=>({row:{flexDirection:"row"},contentStyle:{minWidth:"100%"},emojisContainer:{padding:e.spaces.space12}})));var re=oe;class ne extends a.PureComponent{render(){const{activeSkinTone:e,...t}=this.props,{emoji:s}=this.props,{skin_variations:o}=s,{codepoint:r}=e,n=v(o,r),c=r&&o&&o[r];return 0!==n||c?1===n&&c?a.createElement(J,i()({},t,{spritePosition:c.sprite_position})):a.createElement(re,i()({},t,{activeSkinTone:e})):a.createElement(J,i()({},t,{spritePosition:s.sprite_position}))}}var ae=ne,ce=a.forwardRef((function(e,t){const[s,o]=a.useState(!0),r=a.useRef({containerRef:null,intersectionObserver:window.IntersectionObserver&&new window.IntersectionObserver(((e,t)=>{const{intersectionObserver:s}=r.current;e.some((e=>e.isIntersecting))&&s&&(s.disconnect(),o(!1))}))});a.useLayoutEffect((()=>{s&&e.isActiveCategory&&o(!1)}),[s,e.isActiveCategory]),a.useEffect((()=>{const{containerRef:e,intersectionObserver:t}=r.current;e&&t&&t.observe(e)}),[r.current.containerRef,r.current.intersectionObserver]);const n=a.useMemo((()=>e=>{const s=Q.a.findDOMNode(e);s instanceof HTMLElement?r.current.containerRef=s:r.current.containerRef=null,"function"==typeof t&&t(e)}),[t]);return s?a.createElement(le,i()({ref:n},e,{withPlaceholder:!0})):a.createElement(le,i()({},e,{ref:t}))}));class le extends a.PureComponent{constructor(e){super(e),n()(this,"_top",0),n()(this,"_bottom",0),n()(this,"_renderEmptyState",(()=>{const{notFoundHeader:e,notFoundMessage:t}=D;return a.createElement(q.a,{header:e,message:t})})),n()(this,"updatePosition",(()=>{const e=Q.a.findDOMNode(this._containerRef.current),t=e&&e.parentNode;if(e&&e instanceof window.HTMLElement&&t&&t instanceof window.HTMLElement){const{top:s,height:o}=e.getBoundingClientRect(),{top:i}=t.getBoundingClientRect();this._top=s-i+t.scrollTop,this._bottom=this._top+o}})),n()(this,"getTop",(()=>this._top)),n()(this,"getBottom",(()=>this._bottom)),n()(this,"updateDisplay",(e=>{const t=Q.a.findDOMNode(this._containerRef.current);t&&t instanceof window.HTMLElement&&t.style&&(t.style.display=e?"flex":"none")})),this._containerRef=a.createRef()}componentDidMount(){this.updatePosition()}componentDidUpdate(e){e.emojiIDs!==this.props.emojiIDs&&this.updatePosition()}render(){const{name:e,emojiIDs:t,headerButton:s,onStickyHeaderRef:o,withEmptyState:i}=this.props,r=t.length>0||i;return a.createElement(u.a,{key:e,ref:this._containerRef},a.createElement(u.a,{key:e,ref:this._containerRef,style:r?he.shown:he.hidden},a.createElement(u.a,{ref:o,style:he.headerContainer},a.createElement(te,{style:he.headerSection},a.createElement(N.c,{size:"large",style:he.header,weight:"bold"},e),s)),i?this._renderEmptyState():a.createElement(te,null,this._renderEmojis())))}_renderEmojis(){const{emojiIDs:e,rowSize:t}=this.props,s=Math.ceil(e.length/t),o=Object(Z.a)(0,s);return a.createElement(u.a,{style:he.emojiGroup},o.map((s=>{const o=e.slice(s*t,(s+1)*t);return a.createElement(u.a,{key:`emoji-row-${s}`,style:he.emojiRow},this.props.withPlaceholder?a.createElement(u.a,{style:[he.rowItem,he.spacer]}):this._renderRow(o))})))}_renderRow(e){const{activeSkinTone:t,ariaDescendantId:s,data:o,focusedEmojiId:r,onFocusedEmojiRef:n,onEmojiFocus:c,onEmojiHover:l,rowSize:h,onSelect:d,spriteUrl:m}=this.props;return Object(Z.a)(0,h).map((h=>{const p=e[h];if(!p)return a.createElement(u.a,{key:`row-spacer-${h}`,style:he.rowItem},a.createElement(u.a,{style:he.spacer}));const f=o.emojis[p.toLowerCase()];if(!f)return null;const g=!!f.skin_variations,{spriteSheetColumns:_,spriteSheetRows:y}=o,v={ariaDescendantId:p===r?s:void 0,emoji:f,onFocus:c,onHover:l,onSelect:d,spriteUrl:m,spriteSheetRows:y,spriteSheetColumns:_};return a.createElement(u.a,{key:f.unified,ref:p===r?n:void 0,style:he.rowItem},g?a.createElement(ae,i()({},v,{activeSkinTone:t})):a.createElement(J,v))}))}}n()(le,"defaultProps",{headerButton:null,rowSize:9,withEmptyState:!1});const he=d.a.create((e=>({emojiGroup:{flexDirection:"column",flexWrap:"wrap"},emojiRow:{flexDirection:"row",justifyContent:"space-between"},header:{paddingHorizontal:e.spaces.space4},headerSection:{alignItems:"center",flexDirection:"row",justifyContent:"space-between"},headerContainer:{position:"sticky",top:0,zIndex:1},hidden:{display:"none"},shown:{display:"flex"},rowItem:{flex:1},spacer:{alignSelf:"center",margin:x.EmojiGutter,height:x.EmojiHeight,width:x.EmojiWidth}})));var de=s("zrc3"),ue=s("Myq3"),me=s("EhiH");class pe{constructor(e,t,s){this._categories=e,this._rowSize=s,this._emojis=t}getInitialFocus(){const e=Object(de.a)(this._categories,(e=>e.emojis.length>0));return this.formatFocusParams(0,0,this._categories[e])}getCategoryById(e){const t=Object(de.a)(this._categories,(t=>t.id===e));return this._categories[t]}getPreviousCategory(e){if(e===F)return;const t=Object(de.a)(this._categories,(t=>t.id===e));return Object(ue.a)(this._categories.slice(0,t),(e=>e.emojis.length>0))}getNextCategory(e){if(e===F)return;const t=Object(de.a)(this._categories,(t=>t.id===e))+1;return Object(me.a)(this._categories.slice(t,this._categories.length),(e=>e.emojis.length>0))}getCategoryLastRow(e){const{length:t}=e.emojis;return t<this._rowSize?0:Math.ceil(t/this._rowSize)-1}getLastRowLength(e){const{length:t}=e.emojis;return t?t%this._rowSize||this._rowSize:0}formatFocusParams(e,t,s){const o=s.emojis[e*this._rowSize+t];return{focusRow:e,focusCol:t,focusCategoryId:s.id,focusItem:o,previewEmoji:this._emojis[o]}}focusCategory(e){return this.formatFocusParams(0,0,this.getCategoryById(e))}focusNextColumn({focusRow:e,focusCol:t,focusCategoryId:s}){if(e<0||t<0||!s)return this.getInitialFocus();let o=e,i=t,r=this.getCategoryById(s);if(o*this._rowSize+i+1>=r.emojis.length){if(r=this.getNextCategory(s),!r)return this.formatFocusParams(e,t,this.getCategoryById(s));o=0,i=0}else o+=i===this._rowSize-1?1:0,i=i===this._rowSize-1?0:i+1;return this.formatFocusParams(o,i,r)}focusPreviousColumn({focusRow:e,focusCol:t,focusCategoryId:s}){if(e<0||t<0||!s)return this.getInitialFocus();let o=e,i=t,r=this.getCategoryById(s);if(o*this._rowSize+i-1<0){if(r=this.getPreviousCategory(s),!r)return this.formatFocusParams(e,t,this.getCategoryById(s));o=this.getCategoryLastRow(r),i=this.getLastRowLength(r)-1}else o-=0===i?1:0,i=0===i?this._rowSize-1:i-1;return this.formatFocusParams(o,i,r)}focusNextRow({focusRow:e,focusCol:t,focusCategoryId:s}){if(e<0||t<0||!s)return this.getInitialFocus();let o=e,i=t,r=this.getCategoryById(s);if(o*this._rowSize+i+this._rowSize>=r.emojis.length)if(o<this.getCategoryLastRow(r))o+=1,i=this.getLastRowLength(r)-1;else{if(r=this.getNextCategory(s),!r)return this.formatFocusParams(e,t,this.getCategoryById(s));o=0,i=Math.min(i,r.emojis.length-1)}else o+=1;return this.formatFocusParams(o,i,r)}focusPreviousRow({focusRow:e,focusCol:t,focusCategoryId:s}){if(e<0||t<0||!s)return this.getInitialFocus();let o=e,i=t,r=this.getCategoryById(s);if(o*this._rowSize+i-this._rowSize<0){if(r=this.getPreviousCategory(s),!r)return this.formatFocusParams(e,t,this.getCategoryById(s));o=this.getCategoryLastRow(r),i=Math.min(i,this.getLastRowLength(r)-1)}else o-=1;return this.formatFocusParams(o,i,r)}}var fe=s("xoZN"),ge=s("s1N3"),_e=s("tn7R");function ye(e,t){const s=[...t];let o=0,i=e;for(;o<s.length;){const e=i.children[s[o]];if(!e)break;o+=1,i=e}return{node:i,tail:s.slice(o)}}function ve(e,t,s){const{node:o,tail:i}=ye(e,t);let r=o;i.forEach(((e,t)=>{const s={results:[],children:{}};r.children[e]=s,r=s})),r.results?r.results.push(s):r.results=[s]}function we(e,t){const{node:s,tail:o}=ye(e,t);if(!s||o.length>0)return[];const i=[];return function e(t){t.results.length&&i.push(...t.results),Object(_e.a)(t.children).forEach((t=>e(t)))}(s),Object(ge.a)(i)}const Se=(e,t)=>{const s=Object(ge.a)(e),o=Object(ge.a)(t);return s.filter((e=>o.indexOf(e)>=0))};var Ce=class{constructor(e){n()(this,"_getScoreAndInsertResults",((e,t,s)=>{const o={};for(const i in e){const r=e[i],{search:n}=r,a=n.indexOf(t);if(-1!==a){let e=a+1;t===i&&(e=0),ve(s,t,r),o[i]=e}}return o})),this._data=e,this._index={results:[],children:{}},this._originalEmojis=this._data.emojis}search(e,t){const s=t&&t.maxResults?t.maxResults:75;let o=[];const i=this._originalEmojis,r=this._index;if(e.length){let t=e.toLowerCase().split(/[\s|,|\-|_]+/);t=t.slice(0,2);const s=t.map((e=>{let t=[];const s=we(r,e);if(0===s.length){const s=this._getScoreAndInsertResults(i,e,r);t=we(r,e),t.sort(((e,t)=>s[e.id]-s[t.id]))}else t=s;return t})).filter((e=>!!e));o=s.length>1?Se(...s):s.length?s[0]:[]}return o.length>s&&(o=o.slice(0,s)),o}},ke=s("6OUF"),je=s("VwDm"),Ee=s("fs1G"),be=s("VY6S");const Re=a.forwardRef(((e,t)=>{const{autoFocus:s=!1,maxResults:o=75,onSearch:i=Ee.a,data:r,ariaActiveDescendant:n,categoriesDomId:c}=e,l=a.useState("")[1],h=a.useMemo((()=>new Ce(r)),[r]),d=a.useMemo((()=>Object(be.a)((function(e){const t=h.search(e,{maxResults:o});i(e,t)}),100)),[h,o,i]),m=a.useCallback((e=>{const t=e.target&&e.target.value||"";l(t),d(t)}),[l,d]),p=a.useCallback((()=>{l(""),d("")}),[l,d]);return a.createElement(u.a,{accessibilityRole:"combobox"},a.createElement(ke.a,{Icon:je.a,ariaActiveDescendant:n,ariaControls:c,ariaExpanded:!0,ariaLabel:D.search,autoFocus:s,inputStyle:Ie.textInput,onChange:m,onClear:p,placeholder:D.search,ref:t,style:Ie.fieldTextInput,withClearButton:!0}))})),Ie=d.a.create((e=>({textInput:{paddingVertical:e.spaces.space4,paddingLeft:e.spaces.space4},fieldTextInput:{margin:e.spaces.space4}})));var Pe=a.memo(Re),Te=s("IMYl");class De extends a.Component{constructor(...e){super(...e),n()(this,"_handleFocus",(()=>{const{onFocus:e,skinTone:t}=this.props;e&&e(t)})),n()(this,"_handleFocusLost",(()=>{const{onFocusLost:e,skinTone:t}=this.props;e&&e(t)})),n()(this,"_handleHover",(()=>{const{onHover:e,skinTone:t}=this.props;e&&e(t)})),n()(this,"_handleHoverLeave",(()=>{const{onHoverLeave:e,skinTone:t}=this.props;e&&e(t)})),n()(this,"_handleClick",(()=>{const{onSelect:e,skinTone:t}=this.props;e&&e(t)})),n()(this,"_handleKeyDown",(e=>{const{key:t}=e,{altKey:s,ctrlKey:o,metaKey:i}=e;s||o||i||t===h.a.Enter&&(this._handleClick(),e.preventDefault(),e.stopPropagation())}))}render(){const{accessibilityLabel:e,skinTone:t,isSelected:s,accessibilityRole:o,style:i}=this.props,r=l.a.generate({backgroundColor:t.color,color:d.a.theme.colors.white});return a.createElement(c.a,{onFocusRingGained:this._handleFocus,onFocusRingLost:this._handleFocusLost,onHoverIn:this._handleHover,onHoverOut:this._handleHoverLeave},(({isHovered:n,isFocused:c,isPressed:l})=>a.createElement(u.a,{accessibilityLabel:e,accessibilityRole:o||"button",accessibilityState:{checked:!!s},focusable:!0,onClick:this._handleClick,onKeyDown:c?this._handleKeyDown:void 0,style:i},a.createElement(u.a,{style:[xe.root,{backgroundColor:t.color},r.transitionStyle,(n||c)&&r.focusedStyle,(l||s)&&xe.selected]},s?a.createElement(Te.a,{style:xe.checkmarkIcon}):null))))}}const xe=d.a.create((e=>({outer:{paddingLeft:e.spaces.space4},root:{alignItems:"center",justifyContent:"center",height:"1.25em",width:"1.25em",borderRadius:e.borderRadii.infinite},selected:{boxShadow:`0 0 0 ${e.borderWidths.medium} ${e.colors.primary}`},checkmarkIcon:{height:"1em",width:"1em",color:e.colors.cellBackground}})));var Fe=De;class He extends a.Component{constructor(...e){super(...e),n()(this,"state",{showPalette:!1,focusedOption:void 0,hoveredOption:void 0}),n()(this,"_renderPalette",(()=>{const{activeSkinTone:e}=this.props;return a.createElement(u.a,{accessibilityRole:"radiogroup",style:Le.palette},Object(_e.a)(T).map((t=>{const s=t===e;return a.createElement(Fe,{accessibilityLabel:t.name,accessibilityRole:"radio",isSelected:s,key:t.id,onFocus:this._handleSkinToneFocus,onFocusLost:this._handleSkinToneFocusLost,onHover:this._handleSkinToneHover,onHoverLeave:this._handleSkinToneHoverLeave,onSelect:this._handleSkinToneSelectionClick,skinTone:t,style:Le.skinToneOption})})))})),n()(this,"_renderCurrentSkinTone",(()=>{const{activeSkinTone:e}=this.props;return a.createElement(Fe,{accessibilityLabel:D.skintext,isSelected:!0,onSelect:this._handleShowPaletteClick,skinTone:e})})),n()(this,"_handleShowPaletteClick",(()=>{this.setState({showPalette:!0})})),n()(this,"_handleSkinToneSelectionClick",(e=>{this.setState({showPalette:!1}),this.props.onSelect(e)})),n()(this,"_handleSkinToneHover",(e=>{this.setState({hoveredOption:e},this._handlePreview)})),n()(this,"_handleSkinToneHoverLeave",(e=>{this.setState({hoveredOption:void 0},this._handlePreview)})),n()(this,"_handleSkinToneFocus",(e=>{this.setState({focusedOption:e},this._handlePreview)})),n()(this,"_handleSkinToneFocusLost",(e=>{this.setState({focusedOption:void 0},this._handlePreview)})),n()(this,"_handlePreview",(()=>{const{onPreview:e}=this.props;e&&e(this.state.hoveredOption||this.state.focusedOption)}))}render(){const{showPalette:e}=this.state,{style:t}=this.props;return a.createElement(u.a,{style:t},e?this._renderPalette():this._renderCurrentSkinTone())}}const Le=d.a.create((e=>({palette:{flexDirection:"row"},skinToneOption:{paddingHorizontal:e.spaces.space2}})));var Oe=He,Be=s("iChn");const ze={name:"a",keywords:"j",sprite_position:"k",skin_variations:"l"},Ae={unified:"key",skin_tone:"d",sprite_position:"k"},Ue=e=>{const t=[],s=(e,s)=>{e&&(Array.isArray(e)?e:[e]).forEach((e=>{(s?e.split(/[-|_|\s]+/):[e]).forEach((e=>{const s=e.toLowerCase();-1===t.indexOf(s)&&t.push(s)}))}))};return s(e.short_names,!0),s(e.name,!0),s(e.keywords,!1),t.join(",")},Me=(e,t)=>{for(const s in t)e[s]=e[t[s]],delete e[t[s]]};var Ne=s("Qyxo"),Ke=s("Iok7");const We="emojiPicker2",Ve=[F,H],$e="emoji_picker_categories_dom_id";class Ge extends a.PureComponent{constructor(e){super(e),n()(this,"_categoryRefs",{}),n()(this,"_scrollRef",a.createRef()),n()(this,"_searchRef",a.createRef()),n()(this,"_selectedEmojis",[]),n()(this,"_shouldScrollToFocusedItem",!0),n()(this,"_shouldUpdateScrollPosition",!1),n()(this,"_renderAnchors",(e=>{const{activeCategory:t,query:s}=this.state;return a.createElement(M,{activeCategory:s?void 0:t,categories:e,disableAll:!!s,emojiData:this._uncompressedData.emojis,onAnchorClick:this._handleAnchorClick})})),n()(this,"_renderSearch",(()=>a.createElement(Pe,{ariaActiveDescendant:this.state.ariaDescendantId,autoFocus:!0,categoriesDomId:$e,data:this._uncompressedData,onSearch:this._handleSearch,ref:this._searchRef}))),n()(this,"_renderCategories",(e=>{const{spriteUrl:t,rowSize:s}=this.props,{activeSkinTone:o,activeCategory:r,ariaDescendantId:n,focusCategoryId:c,focusItem:l,query:h}=this.state;return a.createElement(Ke.a,{accessibilityRole:"listbox",nativeID:$e,onMouseLeave:this._handleClearPreview,onScroll:this._handleScroll,ref:this._scrollRef,scrollEventThrottle:100,style:Je.categoriesContainer},e.map(((e,d)=>{const u=c===e.id,m=r&&r.id===e.id,p={activeSkinTone:o,ariaDescendantId:u?n:void 0,data:this._uncompressedData,emojiIDs:e.emojis,focusedEmojiId:u?l:void 0,id:e.id,isActiveCategory:m,name:e.name,onEmojiFocus:this._handleEmojiPreview,onEmojiHover:this._handleEmojiPreview,onFocusedEmojiRef:u?this._handleFocusedItemRef:void 0,onSelect:this._handleSelect,onStickyHeaderRef:m?this._handleStickyHeaderRef:void 0,rowSize:s,spriteUrl:t};return"recent"===e.id&&(p.headerButton=a.createElement(K.a,{accessibilityLabel:D.clear,onPress:this._handleClearRecent,size:"small",type:"text"},D.clear)),e.id===F&&(p.withEmptyState=!e.emojis.length&&!!h),a.createElement(ce,i()({},p,{key:e.name,ref:this._setCategoryRef(`category-${e.id}`)}))})))})),n()(this,"_scrollEmojiIntoViewIfNeeded",(()=>{this._shouldScrollToFocusedItem&&this._focusedItemRef&&(!function(e,t,s=0){if(e&&t){const{height:o,top:i}=e.getBoundingClientRect(),r=i+s,{top:n,bottom:a}=t.getBoundingClientRect(),c=o+i;if(n<r){const t=r-n;e.scrollTop=Math.max(0,e.scrollTop-t)}else if(n>c||a>c){const t=a-c;e.scrollTop=Math.max(0,e.scrollTop+t)}}}(this._getScrollParent(),this._focusedItemRef,this._getStickyHeaderOffset()),this._shouldScrollToFocusedItem=!1)})),n()(this,"_handleStickyHeaderRef",(e=>{this._stickyHeaderRef=e,this._stickyHeaderHeight=void 0,this._shouldScrollToFocusedItem=!0})),n()(this,"_handleFocusedItemRef",(e=>{this._focusedItemRef=e,this._scrollEmojiIntoViewIfNeeded()})),n()(this,"_getStickyHeaderOffset",(()=>{if(void 0===this._stickyHeaderHeight){const e=this._stickyHeaderRef;if(e){const{height:t}=e.getBoundingClientRect();this._stickyHeaderHeight=t}}return this._stickyHeaderHeight||0})),n()(this,"_handleSkinToneSelect",(e=>{this.setState({activeSkinTone:e,previewSkinTone:void 0,withDescription:!0}),this._focusSearch()})),n()(this,"_handleSkinTonePreview",(e=>{this.setState({previewSkinTone:e,withDescription:!1})})),n()(this,"_renderPreview",(()=>{const{previewEmoji:e,activeSkinTone:t,previewSkinTone:s}=this.state,o=e||this._defaultPreviewEmoji,i=s||t;return a.createElement(K.a,{accessibilityLabel:o.name,icon:a.createElement(B,{emoji:o,skinTone:i,style:Je.twemoji}),onClick:this._handlePreviewClick,type:"text"})})),n()(this,"_handlePreviewClick",(()=>{const{previewEmoji:e}=this.state,t=e||this._defaultPreviewEmoji;this._handleSelect(t)})),n()(this,"_renderEmojiDescription",(()=>{const{previewEmoji:e}=this.state;return e?a.createElement(N.c,{align:"left",color:"gray600",numberOfLines:1,size:"small",style:Je.emojiDescription},e.name):null})),n()(this,"_renderFooter",(()=>{const{withDescription:e}=this.state;return a.createElement(u.a,{style:Je.footer},this._renderPreview(),e?this._renderEmojiDescription():null,a.createElement(Oe,{activeSkinTone:this.state.activeSkinTone,onPreview:this._handleSkinTonePreview,onSelect:this._handleSkinToneSelect,style:Je.skinTonePicker}))})),n()(this,"_setCategoryRef",(e=>t=>{t&&(this._categoryRefs[e]=t)})),n()(this,"_handleKeyDown",(e=>{const{key:t}=e,{altKey:s,ctrlKey:o,metaKey:i}=e,{focusRow:r,focusCol:n,focusCategoryId:a,focusItem:c}=this.state,l={focusRow:r,focusCol:n,focusCategoryId:a};if(!(s||o||i))return t===h.a.ArrowDown?(this._updateFocus(this._focusHelper.focusNextRow(l)),void e.preventDefault()):t===h.a.ArrowUp?(this._updateFocus(this._focusHelper.focusPreviousRow(l)),void e.preventDefault()):t===h.a.ArrowRight?(this._updateFocus(this._focusHelper.focusNextColumn(l)),void e.preventDefault()):t===h.a.ArrowLeft?(this._updateFocus(this._focusHelper.focusPreviousColumn(l)),void e.preventDefault()):t===h.a.Enter&&c?(this._handleSelect(this._uncompressedData.emojis[c]),void e.preventDefault()):void 0})),n()(this,"_updateFocus",(e=>{const{ariaDescendantId:t,focusItem:s}=this.state,o=s!==e.focusItem;this._shouldScrollToFocusedItem=o,this.setState({...e,ariaDescendantId:o?w():t})})),n()(this,"_handleScroll",(()=>{this._updateActiveCategory()})),n()(this,"_handleSearch",((e,t)=>{const s=t?t.map((e=>e.unified)):[];Object(_e.a)(this._categoryRefs).forEach((t=>{t&&"search"!==t.props.id&&t.updateDisplay(!e)})),this.setState({searchResults:s,query:e}),this._scrollTo(0)})),n()(this,"_handleSelect",(e=>{const{onSelect:t}=this.props,{activeSkinTone:s}=this.state,o=((e,t)=>{const{name:s,short_names:o,text:i}=e,r=y(e,t),n=r?r.unified:e.unified;return{id:e.id||o[0],name:s,text:i||n,unified:n}})(e,s);t&&t(o);const i=[];for(let t=this._selectedEmojis.length;t>=0;t--){const s=t===this._selectedEmojis.length?e.unified:this._selectedEmojis[t];i.indexOf(s)<0&&i.push(s)}this._selectedEmojis=i.reverse()})),n()(this,"_handleClearRecent",(e=>{this._selectedEmojis=[],this.setState({recentlyUsed:[],activeCategory:this._staticCategories()[0]},(()=>{this._shouldUpdateScrollPosition=!0}))})),n()(this,"_getActiveCategory",(()=>{const e=this._scrollRef.current&&Q.a.findDOMNode(this._scrollRef.current);let t=this.state.activeCategory;if(e&&e instanceof window.HTMLElement){const{scrollTop:s}=e;for(let e=0;e<this._categories.length;e++){const o=this._categories[e],i=this._categoryRefs[`category-${o.id}`];if(i&&s>=i.getTop()&&s<i.getBottom()){t=o;break}}}return t})),n()(this,"_updateActiveCategory",(()=>{const e=this._getActiveCategory();e!==this.state.activeCategory&&this.setState({activeCategory:e})})),n()(this,"_getUpdatedRecentlyUsedEmojiList",(()=>{const{recentlyUsed:e}=this.state,{rowSize:t}=this.props;if(0===this._selectedEmojis.length)return e;const s=-2*t;return[...e.filter((e=>this._selectedEmojis.indexOf(e)<0)),...this._selectedEmojis].slice(s)})),n()(this,"_handleClearPreview",(()=>{this.state.previewEmoji&&this.setState({previewEmoji:void 0})})),n()(this,"_handleEmojiPreview",(e=>{e!==this.state.previewEmoji&&this.setState({previewEmoji:e})})),n()(this,"_handleAnchorClick",(e=>{this._shouldUpdateScrollPosition&&(this._shouldUpdateScrollPosition=!1,Object(_e.a)(this._categoryRefs).forEach((e=>e.updatePosition())));const t=this._categoryRefs[`category-${e.id}`];0!==e.emojis.length&&(this.setState({activeCategory:e}),t&&this._scrollTo(t.getTop()+1),this.state.focusItem&&this._updateFocus(this._focusHelper.focusCategory(e.id))),this._focusSearch()})),n()(this,"_focusSearch",(()=>{this._searchRef.current&&this._searchRef.current.focus()})),n()(this,"_scrollTo",(e=>{this._scrollRef.current&&this._scrollRef.current.scrollTo({y:e,animated:!1})})),n()(this,"_staticCategories",(()=>this._categories.filter((e=>-1===Ve.indexOf(e.id)))));const{emojiInfo:t}=this.props;this._uncompressedData=(e=>{const t=JSON.parse(JSON.stringify(e));t.compressed=!1;for(const e in t.emojis){const s=t.emojis[e];Me(s,ze),s.id=e,s.unified=e,s.short_names=[e],s.text||(s.text=""),s.search=Ue(s),s.skin_variations&&(s.skin_variations.forEach((e=>{Me(e,Ae)})),s.skin_variations=Object(Be.a)(s.skin_variations,(e=>{const{skin_tone:t}=e;let s=t[0];for(let e=1;e<t.length;e++)s+=`+${t[e]}`;return s})))}return t})(t||{}),this._categories=this._uncompressedData.categories,this._searchCategoryInitialValue={anchorless:!0,id:F,name:D.searchCategoryName,emojis:[]},this._recentlyUsedCategoryInitialValue={id:H,name:D.recentCategoryName,emojis:[]},this._defaultPreviewEmoji=this._uncompressedData.emojis[this.props.previewEmojiCodepoint],this._categories.unshift(this._recentlyUsedCategoryInitialValue),this._focusHelper=new pe(this._categories,this._uncompressedData.emojis,e.rowSize),this.state={activeCategory:this._categories[1],activeSkinTone:T[e.defaultSkinTone],ariaDescendantId:w(),categories:[this._searchCategoryInitialValue,...this._categories],focusRow:-1,focusCol:-1,recentlyUsed:[],previewSkinTone:void 0,query:"",searchResults:[],withDescription:!0}}componentWillUnmount(){W.a.set(We,{recentlyUsed:this._getUpdatedRecentlyUsedEmojiList(),activeSkinToneId:this.state.activeSkinTone.id})}componentDidMount(){W.a.get(We).then((e=>{if(e&&"object"==typeof e){const{recentlyUsed:t=[],activeSkinToneId:s}=e,o="string"==typeof s&&T[s],i=Object.assign({},{recentlyUsed:Array.isArray(t)?Object(Ne.a)(t,(e=>"string"==typeof e?e:void 0)):[],activeCategory:this._categories[1]},o?{activeSkinTone:o}:{});this.setState(i),this._shouldUpdateScrollPosition=!0}}))}componentDidUpdate(e,t){const{categories:s,searchResults:o,recentlyUsed:i}=this.state,{rowSize:r}=this.props;if(t.searchResults!==o||t.recentlyUsed!==i){const e={...this._searchCategoryInitialValue,emojis:o},t={...this._recentlyUsedCategoryInitialValue,emojis:i.length?[...i].reverse():[]};this.setState({activeCategory:this._getActiveCategory(),categories:[e,t].concat(this._staticCategories()),focusCategoryId:void 0,focusCol:-1,focusRow:-1,focusItem:void 0})}t.categories===s&&e.rowSize===r||(this._focusHelper=new pe(s,this._uncompressedData.emojis,r))}_getScrollParent(){if(!this._scrollParent){const e=Q.a.findDOMNode(this._scrollRef.current);this._scrollParent=e instanceof window.Element?e:void 0}return this._scrollParent}render(){const{partialRender:e}=this.props,{recentlyUsed:t,searchResults:s}=this.state,o={...this._searchCategoryInitialValue,emojis:s},i={...this._recentlyUsedCategoryInitialValue,emojis:t.length?[...t].reverse():[]},r=this._staticCategories(),n=[o,i].concat(r),c=[o,i,r[0]];return a.createElement(fe.a,{onKeyDown:this._handleKeyDown,style:Je.root},a.createElement(te,{style:Je.searchSection},this._renderSearch()),a.createElement(te,{style:Je.anchorsSection},this._renderAnchors(n)),this._renderCategories(e?c:n),a.createElement(te,{style:Je.footerContainer,withTopBorder:!0},this._renderFooter()))}}n()(Ge,"defaultProps",{defaultSkinTone:j,partialRender:!1,previewEmojiCodepoint:"ðŸ‘‹",rowSize:9});const Je=d.a.create((e=>({root:{flex:1},categoriesContainer:{flexShrink:1,overflowY:"auto"},searchSection:{borderTopLeftRadius:e.borderRadii.xLarge,borderTopRightRadius:e.borderRadii.xLarge,padding:0},anchorsSection:{padding:0,marginTop:e.spaces.space4},footer:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",overflow:"hidden"},footerContainer:{borderBottomLeftRadius:e.borderRadii.xLarge,borderBottomRightRadius:e.borderRadii.xLarge},emojiDescription:{paddingHorizontal:e.spaces.space12,maxWidth:"180px",flex:1},twemoji:{height:"2em",width:"2em"},skinTonePicker:{marginHorizontal:e.spaces.space12}})));t.a=Ge}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/ondemand.EmojiPicker.36bb82f5.js.map